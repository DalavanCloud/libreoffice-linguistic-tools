From - Wed Feb 03 20:28:47 2010
X-Account-Key: account4
X-UIDL: 10257
X-Mozilla-Status: 0013
X-Mozilla-Status2: 00000000
X-Mozilla-Keys:                                                                                 
X-TrackIDS: IA
X-ExtScanner: Niversoft's Find_Attachments
Return-Path: <allan_johnson@sil.org>
Received: from ma2.wsfo.org ([208.145.81.17] verified)
  by unipost.net (CommuniGate Pro SMTP 5.2.17)
  with ESMTPS id 27717944 for jim_kornelsen@packmail.net; Wed, 03 Feb 2010 04:06:02 -0500
Received: from mail.link77.net (cgp1.mail.link77.net [172.22.65.13])
	by ma2.wsfo.org (8.13.8/8.13.8) with ESMTP id o1395xVP031284
	(version=TLSv1/SSLv3 cipher=DES-CBC3-SHA bits=168 verify=FAIL)
	for <jim_kornelsen@sil.org>; Wed, 3 Feb 2010 04:05:59 -0500
Resent-Message-Id: <201002030905.o1395xVP031284@ma2.wsfo.org>
Received: from <jim_kornelsen@sil.org>
  by cgp1.mail.link77.net (CommuniGate Pro RULE 5.3.1)
  with RULE id 230999831; Wed, 03 Feb 2010 04:05:59 -0500
X-Autogenerated: Mirror
Resent-From: <jim_kornelsen@sil.org>
Resent-Date: Wed, 03 Feb 2010 04:05:59 -0500
X-CGP-ClamAV-Result: CLEAN
X-VirusScanner: Niversoft's CGPClamav Helper v1.9.7a (ClamAV engine v0.95.3)
X-CGP-ClamAV-Result: CLEAN
X-VirusScanner: Niversoft's CGPClamav Helper v1.9.7a (ClamAV engine v0.95.3)
X-ExtScanner: Niversoft's Find_Attachments
X-Special-Processing: NoLoop-JM
X-Special-Processing: NoLoop-JM
Received: from [125.60.241.201] (account allan_johnson HELO [192.168.1.100])
  by cgp1.mail.link77.net (CommuniGate Pro SMTP 5.3.1)
  with ESMTPSA id 230999868; Wed, 03 Feb 2010 04:05:56 -0500
Message-ID: <4B693C61.2040406@sil.org>
Date: Wed, 03 Feb 2010 17:05:37 +0800
From: Allan Johnson <allan_johnson@sil.org>
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.0; en-US; rv:1.9.1.7) Gecko/20100111 Lightning/1.0b1 Thunderbird/3.0.1
MIME-Version: 1.0
To: jim_kornelsen@sil.org
CC: Beth Bryson <Beth_Bryson@sil.org>
Subject: Re: Fwd: Writeup Tools 0.4
References: <4B6829D3.2080807@sil.org> <926CA672-7F97-448A-9422-DD7D42A85FC1@sil.org>
In-Reply-To: <926CA672-7F97-448A-9422-DD7D42A85FC1@sil.org>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-3.0 (ma2.wsfo.org [172.22.65.4]); Wed, 03 Feb 2010 04:05:59 -0500 (EST)
X-ClamAV-Scanned: Pass ok
X-Spam-Not-Checked: Messages from internal relays not scanned
X-Scanned-By: MIMEDefang 2.67 on 172.22.65.4

Hi Jim & Beth,

I've tested this and have gotten it to work for me. The installation 
went smoothly and the "Writeups" menu appeared in OpenOffice like it's 
supposed to. I exported two texts from FLEx in "Interlinear XML" format. 
Then in OpenOffice I went to "Writeups; Grammar Settings", and added the 
two texts and a short prefix for each one. Then I went to "Writeups; Get 
Grammar Examples", and here I was stuck for a while. It seemed that no 
matter what sort of number I typed in, I'd get an error message telling 
me "Could not find ref number X". The piece of understanding I was 
lacking at first is that I have to type the prefix along with the number 
to search for before it will match. And case has to match. And if there 
is/isn't a hyphen on the prefix, there has to be/not be a hyphen in the 
number I type.

So it's working for me now. The format looks nice. The automatic 
numbering, hanging indents, etc. present it nicely. I'm looking into how 
to adjust the appearance. The structure of the styles is quite a bit 
different from what I'm used to in the interlinear export from FLEx to 
OpenOffice. I don't know enough about it to evaluate which is better, 
but this one does seem simpler. One difference I note is that while this 
format uses a character style for each interlinear line, FLEx's 
OpenOffice format uses paragraph styles for this and doesn't seem to use 
any character styles at all. A few questions on the Writeup Tools format:

1) Where would I go to adjust the width of the hanging indent? I'm not 
finding the style that controls this. It is set to a nice default. It 
handles numbers from 1-99 before it runs into spacing problems. But if 
the font sizes are significantly changed, the hanging indent would need 
to be changed to match.

The texts I'm working with don't have anything meaningful in the part of 
speech field, so I've adjusted the grammar settings to exclude part of 
speech when I insert examples into my test document. Just mentioning 
this detail in case it will make a difference in how things behave for 
the following observations -

2) A nice feature of the format used by the odt export from FLEx is the 
ability to hide lines after export by adjusting OpenOffice styles. I'm 
finding that I can also do this in the format used by Writeup Tools, but 
a funny little glitch prevents the spacing of the remaining lines from 
adjusting itself correctly. There's a vertical line from the 
MorphemeBreak line to the Gloss line at the end of most sentences. When 
either of these lines is hidden, the vertical line stays there and 
creates an unwanted gap. I'm finding that this vertical line corresponds 
to punctuation. For sentences with internal punctuation like a comma, 
the vertical line appears there too, right where the comma should be. 
Probably just a glitch in reading the punctuation from the FLEx XML. It 
would be good to repair this so that the punctuation itself would appear 
rather than these vertical lines.

3) Another glitch in hiding/unhiding lines. When I hide the gloss line, 
the vertical spacing shrinks down to accommodate the shorter length 
required by just the words (this is just what I would want it to do). 
But if I put the gloss line back, the vertical spacing stays shrunk. It 
doesn't grow back to the length needed to accommodate the glosses. If I 
do a bit of editing on one of the glosses, the size of its containing 
morpheme frame does immediately correct itself. But this does nothing 
for all the other shrunken morpheme frames. Is there a setting somewhere 
that would make the frames automatically readjust themselves? I notice 
that the OpenOffice format from FLEx doesn't have this problem. The 
frames freely correct themselves as needed. Could this be related to the 
character style vs. paragraph style difference? I wonder if the 
paragraph styles FLEx uses vs. the character styles used in this format 
may be a workaround for this glitch.

All for now. This seems like a nice tool. I think Joker Daguman would 
have appreciated something like this when I was helping her linguistics 
students use Fieldworks. I wish that this tool and FLEx's own odt export 
would use the same styles. It would be nicer for students (or any user) 
if the same stylesheets could apply to both of these approaches to 
printing interlinear texts.

Allan



On 2/3/2010 9:35 AM, Beth Bryson wrote:
> Allan, I would love it if you could test this also.  This is from 
> folks in India.
>
> I sent him your package, but I may be missing some details about how 
> it all works.
>
> -Beth
>
> Begin forwarded message:
>
>> Resent-From: <beth_bryson@sil.org>
>> From: Jim Kornelsen <jim_kornelsen@sil.org>
>> Date: February 2, 2010 7:34:45 AM CST
>> Subject: Writeup Tools 0.4
>>
>> Hello,
>>
>> In this update, there is better support for Flex.  Because ref 
>> numbers always start with 1.1 in Flex, there is an option to specify 
>> a different prefix for each file.  That way, you can enter a unique 
>> ref no. like #S1-1.1 for the first story and #S2-1.1 for the second 
>> story.  There is also now an unlimited number of files, which is 
>> probably important for Flex where each text is in a different file.
>>
>> Also there is some basic support for creating tables.  Although they 
>> don't look as good as frames, tables seem to work better when it is 
>> necessary to save a copy in .doc format.
>>
>> If you are able to test this, I would be interested to hear how it 
>> works.
>>
>> Jim
>>
>

    FD%   €u                                                      