## Instructions for building the SEC_Call C++ component for the LinguisticTools extension.

Overview:
    The SEC_Call_Component.uno.dll file included with the LinguisticTools
    extension is compiled C++ code.
    The source code is included in the src folder.
    In order to make changes to this component, there is a fairly complex
    build process, described in this document.

First your machine needs the following software, free downloads:
1. OpenOffice.org SDK
    - This has compile tools and libraries needed to build UNO components.
2. OpenOffice.org (which you probably already have)
    - The SDK isn't enough, because other libraries are needed as well.
3. MS Visual C++ Express
4. MS Visual C++ Redistributable Setup (adds some features I think).
5. MinGW make utility.
    - This is a simplified version of GNU make.
    - You don't need the whole MinGW package, only make.
6. InfoZip zip utility.
    - Just zip; no need for unzip.

Next, you need to set a lot of paths so that the appropriate tools and
libraries can be found.  The paths generally point somewhere in the 
directories of the software listed above.  You are likely to get any number
of error messages when building.  However whatever the error message is,
it is probably because you need to add or change a path in some way.
To start setting paths, run this batch file, which will ask a series of
questions about the software listed above:
    "C:\Program Files\OpenOffice.org 3 SDK\sdk\setsdkenv_windows.bat"
    Make sure Auto Deployment is set to YES.
This generates %APPDATA%\openoffice.org3.3_sdk\setsdkenv_windows.bat

Now open a command prompt.
Run the batch file again for this command prompt.
    "C:\Program Files\OpenOffice.org 3 SDK\sdk\setsdkenv_windows.bat"
Also set these environment variables:
    set OFFICE_BASE_PROGRAM_PATH=C:\Program Files\OpenOffice.org 3\Basis\program
    set OO_SDK_URE_HOME=C:\Program Files\OpenOffice.org 3\URE
    set PATH=%PATH%;C:\Program Files\OpenOffice.org 3\URE\bin
Now chdir to this directory, that includes the Makefile.
Close all OOo windows, in order for auto deploy to work.
Run the makefile.
    "C:\Program Files\mingw\bin\mingw32-make.exe"
Note: cppumaker takes a couple of minutes the first time, in order to create
some thousands of files.

Make should create a lot of different files, including an .oxt file.
It creates the files in the examples output directory off of C:\
It should also register the component in OOo.
Now you just need to call it with some Basic code:
    oSM = CreateObject("com.sun.star.ServiceManager")
    secCall = oSM.createInstance("lingtools_module.SEC_Call")
    secCall.PickConverter()

This may work to call the test just once:
c: && cd c:\openoffice.org3.3_sdk\WINlingtools.out\bin && Test_SEC_Call_Component

#-------------------------------------------------------------------------------
## Other notes

To compile SDK examples:
set OO_SDK_URE_HOME=C:\Program Files\OpenOffice.org 3\URE
set OFFICE_BASE_PROGRAM_PATH=C:\Program Files\OpenOffice.org 3\Basis\program
cppumaker seemed to hang, but it got going after I clicked on it in Task Manager.
- or else it just takes a couple of minutes.

Recommend not to do the following, because I can't get it to compile.  Instead, use makefiles.
To compile other code:
set PATH=%PATH%;C:\Program Files\OpenOffice.org 3 SDK\sdk\bin
idlc.exe -I"C:\Program Files\OpenOffice.org 3 SDK\sdk\idl" some.idl
regmerge simple_component.rdb /UCR some.urd
cppumaker -BUCR -Tmy_module.XSomething -O. "C:\Program Files\OpenOffice.org 3\URE\misc\types.rdb" simple_component.rdb
cl.exe service1_impl.cxx service2_impl.cxx -I"C:\Program Files\OpenOffice.org 3 SDK\sdk\include" -I"C:\Program Files\Microsoft Visual Studio9.0\VC\include" -L"C:\Program Files\OpenOffice.org 3 SDK\sdk\lib"


Automatic deployment of UNO components (YES/NO) [YES]:

 ******************************************************************
 * ... "C:\Users\Jim Kornelsen\AppData\Roaming\openoffice.org3.2_sdk\setsdkenv_w
indows.bat"
 * batch file has been prepared.
 * This batch file will be used in the future to prepare your
 * personal configured SDK environment.
 ******************************************************************

Setting environment for using Microsoft Visual Studio 2008 x86 tools.

 ******************************************************************
 *
 * SDK environment is prepared for Windows
 *
 * SDK = C:\Program Files\OpenOffice.org 3 SDK\sdk
 * Office = C:\Program Files\OpenOffice.org 3
 * Office Base = C:\Program Files\OpenOffice.org 3 SDK
 * URE =
 * Make = C:\Program Files\make-mingw32\bin
 * Zip = C:\program files\zip300xn
 * C++ Compiler = C:\Program Files\Microsoft Visual Studio 9.0\VC\bin
 * C# and VB.NET compilers = c:\windows\microsoft.net\framework\v3.5
 * Java =
 * Special Output directory = c:\openoffice.org3.2_sdk
 * Auto deployment = YES
 *
 ******************************************************************
